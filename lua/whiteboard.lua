local vec3 = require("modules.vec3")
local mat4 = require("modules.mat4")
local class = require('pl.class')
local DrawableSurface = require("DrawableSurface")

class.Whiteboard(ui.View)

function Whiteboard:_init(bounds)
  self:super(bounds)

  self.drawableSurface = DrawableSurface(ui.Bounds{size=bounds.size})
  self:addSubview(self.drawableSurface)

  self.half_width = self.drawableSurface.bounds.size.width/2
  self.half_height = self.drawableSurface.bounds.size.height/2
  self.BUTTON_SIZE = 0.2
  self.SPACING = 0.13;
  
  -- RESIZE HANDLE
  self.resizeHandle = ui.ResizeHandle(ui.Bounds(self.half_width+self.SPACING, self.half_height+self.SPACING, 0, self.BUTTON_SIZE, self.BUTTON_SIZE, self.BUTTON_SIZE), {1, 1, 0}, {0, 0, 0})
  self:addSubview(self.resizeHandle)

  -- QUIT BUTTON
  self.quitButton = ui.Button(ui.Bounds{size=ui.Size(0.12,0.12,0.05)}:move( 0.52,0.25,0.025))
  self.quitButton:setDefaultTexture("iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABHNCSVQICAgIfAhkiAAABUtJREFUeJztm+1TGlcUxp9dcEEQ1wFl7VjT5sXMRE3SWmOssUkax6oBtNM/r39DJ8bXWKNJG3XaRGPbqJlpY0zrS+sC4cUFFYHdfohaQMC9cLc6kOfj7p5nz/l593Dv3pX5dvapgiLVxMoy2JNO4qQ0sbIMAMUJ4KB4oAgBJBYPFBmA1OKBIgKQrnigSABkKh4oAgDZigcKHMBxxQMFDEBN8UCBAlBbPFCAAEiKBwB9LjfZDEm5hGmuRbdIHFNwI4BU7wFoaa4PhaAPBDNfoHYhrmi3YtcMQEkgAKF/EMLQCHThcPqLmON9TCtv8MF398Du7NJNcF+aAODcHlT3D0AvSdBLEuxDI2AjEWKf0r9WUTk+Ac7jhTAwqAkE6gCM6xuoHhxOSpbz+WEfeQAmFiPyqRobByPLhx7CwCB04W2q+VIFYF5+DWHkAZi9vSPnDJsi7GPjwH5B2WT4ZxP20TEw8XjScc7nR3X/fZQEs/QVQlEDYFl6icqHk0BK0okyrq6hcvJx+ua3f4xzu2EfHs04WvRbEoR7A+A8XgpZUwLAz83D+uOUqm5tfrUM68zM0RMM3j3rQ6Ngo9GsHrqdHQj3B2HY+DvXlA+VNwBdeBvlLxaIYiwvFsHPzScdK/H5IAyrb5ZsNApheBTGPCHkBCDx7xw3m+B2dEMuKSHyqHg2C8vSSwBASTAIYXCEuMtHbTbs2auIYlJF5RGICAI83Z1QWDI765NpWBaWYB8Yhm6brLvvVdoguu4Sg08VtSa4W1sLb2cHWZCiwDo1DX0oRBQWtVohupyQDQay+6VR/gASnoft8+fgu9met2U2RXkeossBudRIxS9vAErKdFZqbECwpTlf27SKlVsg9rkQN5uoeWoyFQ40fwbpciNVz1hZGcReF+JlZqq+mi2GfO03EK67QMUrbjLB3edErNxCxS9R2i2HGcDb8SV2z9TmZSOXGiH2OhDleUqJJUvbFyIsC3f3Vzn/VssGA0SXE1GrlXJi/0n7N0IsC5njcgqN2KuwZ7NRTihZ2gKQZVR+/xDG9Y2cwkvX1mGdmqacVLK0A6AoqJx4BNObP/OysSwuoWL2OZ2c0kgbAApge/QDzMuvqdjxs3OwLCxS8UoVfQCKAtuTKZT9/gdVW+vUDMyvyDY91Ig6AOvMTyjbX+XRlm3yMYyra1Q9qQKo+PkpLITvBkjEyDLsY+PgRDc1T2oAKuaeg5//lSyIYbB99mOykFgMwvAoOL+f7F4ZRAVA+S+/gX82Rxznb2uFp6cLW1evEMWxkQiqhkahl/Lfo6QCQDZwAKNilyNBgdbrh4X721oRvlhHFK8PhWBZzL/X5AQgtdRQ/SV4ujoBnU5VfLC5CcGmTxIMGXjv3MbOR2dU5yBdaYS/9brq6zMp7xFwAGP73FmIzh4ox0x7tz69ikDLtTSZsPB0dSJSXX3sPQMt1+Brv6Fqa+04Uf0V2K2pwWafE/HS0rTnpcuN8H/emjFe0evhdnQjasuw+GEY+G59gWBzE410AWgwD9irqoL4TR/i5uQXF6H6S/C1tx0b/24F6Di69tfp4O3sgNRQTzNdbabCUZ6H+LXrEEL4Yh3e3rqpulHGTSa4XY7DkaRwHERHD8IXzlPPVbPF0AEEqbEBb+/cJn5eozwPt/MuYuXl2Ox1YvfDGi3SBJPL/wv8n98IMbKser+hIL8RIt1sIdWpB6C13gM46QROWjl9KJlLszmtIh4BpJ+innYRASi04gECAIVYPKCiBxRq4QfKOgIKvXggC4BiKB7IAKBYigfSACim4oGEJlhshR+IBYq3eAD4FzLNyUTM0XqEAAAAAElFTkSuQmCC")
  self.quitButton.onActivated = function()
    self.app:quit()
  end
  self:addSubview(self.quitButton)
  
  -- CLEAR BUTTON
  self.clearButton = ui.Button(ui.Bounds(0,0,0, self.BUTTON_SIZE, self.BUTTON_SIZE, self.BUTTON_SIZE))
  self.clearButton:setDefaultTexture("iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMKSURBVHgB7ZtBaBNBGIXfFm9tSk9KbqkQb0WJID1pU48q9aqIXtKrbT0ba8zdJNe2B0HRc9EcxdaTCiaB3ixobgVPQus5zjOZsB1XSGdnNnRnPhg2mQ07897O7P75dyeAQq/XWxCb26IsiZJDOugMSiUIgm7kL4TwGVFqvfRDjTNSdyDFi80HUS7BDTgaimI0/JoYVKzDHfGEWqkZgTj7ObH9Ed57cPAT1Uod+/vfcXj4G6edq9fmsfaohGz2nLqrSANeiA8PZA3F37/3MBXCw0xlJvHyVUM1ocEpcDFcU3u+kTrx5EhoqlYaavUSDTg29z/ufkZa+SamtEJuAg5xFDGynTIgCm8AHMd5A85Akxs3r6NQmEP1WR06fPry9tj3+Su3oEP5ySparT00372HDloGUDwbluiaEBf2gX1hITomaE0BnnmJakZSSPFRfToJWgbwjIfdTtoEVTz7ojsKtS+C4zLBpHgS6y6QtAmmxZPYt8GkTLAhnhiJA2ybYEs8MRYI2TLBpniiHQhFITsmO8zkyv8YNfAJH8O0eGLUACI7yI5vbb5GXOQxstmzVgIupsR64QrdkPS0oIbg/t8gHMcbAMfxCRFooF5JozB5NxmlPd02/RSA4/hrADRIOlq02Z6fAnAcbwAcxxsACzCNVVq+A1PwWLayzcYzQmoOb2vzTeTvRn02SPGl5bvD76azQkZHgCo+4q2sExM+ho2UuzEDbGVvbafcjRhgO3Vt04TYBtgWL7FlQiwDkhIvsWGCtgFJi5eYNkHLgHGJl5g0QcuA1te94eekxUtUE/iekA5agVCz2W+4cHluLOIlbJvPtdpt/Zek/KMxOI43AI7jDVArMplJuAQN6IYr8vnzSCtcPKXQoQHb4Zry+moqR8H09NTflWMKHcYBC+gvmhzC93vqtQ3s7ox3/VAQBIgLT2b+wiwel1eiEjSzcuUow7kVuEVdGLzm6tLZtiiLw6Wz/CA2RVEaSDcM+znaFwea8c8kGyylfYr+gsqkR0QPduiif7HfFsJ3wjv+AOBGWzaSXkcaAAAAAElFTkSuQmCC")
  self.clearButton:setHighlightTexture("iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAJtSURBVHgB7ZsxThtBFIb/sXIAqkhORQ6AEjlSlBKTMomgTWrouQABkgNgaqihRuASQYmQMJY4AO4sqLjBMr/Wz+DVIsHbmbXkN580Whutduf/mPWOn3ccCmRZtug3K74t+zaP2aA/atvOuUHpHj74nG872ezDjHOS20l4vznz7TNswNHQ9qPhoTH6wybshCfMysxw/r8/77e3sEmbI2ALdlmhgE+wyzIvgQyGacA4SQCMkwTAOO+gpHtyit7VDTY216Hh29dfE+8vLo+h4f+/DlqtBfz4+R0aVAIYnicWtBKqwj6wL2xEI0F1CfR6N+PX3a6Xsd1B3Uj4sj69BZWAjb/rE7brllAMz76wTxrUH4LTkhAyPKl0F6hbQujwpPJtsC4JMcKTIPOA2BJihSfBJkKxJMQMT9QToTKkY9Lh5of3L+772olPs/l0jNDhSVABRDrIjq+u/UFV5BjD4X3w8CQVRGCcJADGSQJgHNVtsFjMKENb4NCeT3vOdAnAOOYFpJkgjJMEwDhJAIwTRQDLWPt7hwgFjxWr2hy8IlSs4a2u/S7d77W/DTL8/t7B+H3on+GCjoBi+OHwDlV5fowYJfdgAmJVb2OX3IMIiF26jimhsoDY4YVYEioJqCu8EEOCWkDd4YXQElQCphVeCClBJYDP5Ah1hxeKElpfFqBBNRGSE/OxlGmEF+TcVR6SSgURGCcJgHGSABiHAgawS58CjmCXPucBi8gXTVrkY8M5d+5f7MIeHa4jtrp09tq3pfHSWb7wmzZmfyRw2s+vjUujzPni6Yk98qW0W8gXVNY9ImJ9Lxkg/7A/Gl3yYx4BTVkmbAQI6hkAAAAASUVORK5CYII=")
  self.clearButton:setActivatedTexture("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")
  self.clearButton.onActivated = function()
    self.drawableSurface:clearBoard()
  end
  self:addSubview(self.clearButton)
  
  -- BRUSH SIZE DOWN BUTTON
  self.brushSizeDownButton = ui.Button(ui.Bounds(0,0,0, self.BUTTON_SIZE, self.BUTTON_SIZE, self.BUTTON_SIZE))
  self.brushSizeDownButton:setDefaultTexture("iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAVXSURBVHgB7ZtNbBtFFMffVtxwq57aOKckUtxLKmgioZ7aJnBrwXAiRQUOOAhxIB8SSIiGEgJIgNQ4HBBqioSggnBCoc2tX+kprRQnUnuKpTanOOmpkt2z+/4bbzT7dtPaM7Pr1puftLK9ttb73rx58z5mHRJUq9UT/PI2H1k+Oqg1WKkdE47jrIX+ggXfz8dUtfWBjPs9uR1PeH65wcerlAxgDf1sDY/21E6co+QIDyArZCaHR7+DXx+o35ZKD2lyIk/F4n0qlx/Ti86x40dpdCxH6fRB+VU/FPAHv/nQOwPhPzjzWUsIrpLa+zL9dWlaKmEaU+AV9czU+QstJzyosEyTE9PydBYK8M39Wwu3qVVZ5Skt6NhDCaISYtmJUkAYuwqghJN4BbxEMdHb10Pd3V3U23uYMoc6KZVK0V5emwGW3Y3SJq2vP6RC4a57FFcfUBwgEKqqJ46+9ibZAgK+O/gWnTz1elgU9lQQkF2c+ZsKS3fd97ZYvHPZ9zkyBeSGTrPw2e1R1gXCz1+5ysr4h2wgFWDdB6TTB9yQMzf0nrHw3vVwrf/mfnff28aqD4Cpj4wOhQqOeY7kauHmIpv1PdrY2NwOufF7+IfuTCf7isN0nJMXCYT/89Iv9N23eVpYWCRbWJsCEH7865HAeQj57+z/fMzVnWNA2JOn3uBjINR3TLIS5q9cIx0i8QEYsR9//ipwHoLDkekmV575Q7kSXSVY9wG4ybMhI58/f5EzyxmjzNKtS7CguJYEU82GTzBWwK+//RCY87jpWTZ5W+BaKNCo4D9/CrG6RjFSAJY6OUcxWrrz82nMz18LWEJ3psu9BxO0FbDlqPxzE4LbHHkJrj3LfkXFNNbQVgBCWnX0vcgtaqRT9aJNXbQVkPvYb3oYfZsh605U3GXVb2VYMnXRUkCG556c+whX4wLTQLUCTEdYpA5aCjjS2+P7jOgujtH3gBUUV/31vQxHkTpoKaCvz6/tZU5f40aGw0fitIB0u9/8V2PK3VWWC/d8nzOHukgHrWSorc0fgRWD5eZAyGmKDNHXuYCikkrpLYVaFiDX3WY0UmSJWzcW2C2KkgZlS9o3IWXJCrV8QKVS8QkNn1Au+x2hzdpiGHLZKwmfUC9aFiArtnJZjANUkFRK63pxiJYClpb86/6xkBJW1NiKRaxYANLSOP0AQl+pdDko9aKlADQu1DlnmpE1ikzDEYYXi3rBmPYyKIseNnoA9RBWhzBJw7UVIDMyCP9Rzqw6Uw8okso6RGFJPxfRVkBYXj54OkuDEU4Fr82mYlqHMIoE0a6SaenI2FBoGdsUXHOUr61iowplHAp/8fn3gSgMDRKbloCRl00X/Oenn3xJphgrAKOQ5/q/BJaAmzap3cOvjIzlAiMP0CKzUYSx0htEyRqMn/OPEswWvT6UyxqZq96yutPKMmmxP2i1PY7gBKO+03LoNkax+YHrBwim1OZoW62uhzbbToEVfp+fmjHqO0S+PwAmj25RoxsingWcLfyNqdlHvj8AN/hONueuELoZmgpGHdd6/8xwJIXXSLfIeOVq9BAa3yKzyaZ+vaG2ej3EtkVG4m6Q6utxnWJ7+wGuIRz0bZJCjQHFVUR18A+FiCrNTVPA80LkPuBFY1cBlHB2FSBPNKPE3UyggDX1hKy2thIhxdsVKMBX1UBC04pWsG9fyn1yTLCCOOAEbT00uY2b4k5d4OSlec8POY5DNnB3oXIT5ez4cFg02uk9OYo9aMOULPKs5NGkPjq7zMfA9qOzeMMv/XxMU2uDsB/WPlCTmQITrfYo7Te09UBlnBZRpehYoy1nP8eC31S/eAK1RE6zBHto6AAAAABJRU5ErkJggg==")
  self.brushSizeDownButton:setHighlightTexture("iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAATFSURBVHgB7Zs9bBNJFMffRteRSFQQU+GTnGuAu7Olu1xzzgddAENFQIiGBCEKZBACgQhfAQqEiGkQUkLDZyjDRwcioQIkmwioYomkIoYKKaY277/ORrvjtXDezK5C1j9ptfZms973nzdv3rzZtUihUql08W4nbxneNtLqYHpxu2BZ1pzvGWz4Wt5GKqsf2LjWsdtyjOfdS97+omgAb+hmb/jWsnjgHEXHeABbYTNZ3PobeT9L0aQbHnCeostOCPAnRZcMukCFIkwLRZymABRxmgJQxPmNQqJQ+EDFmVnK57H/ROXyd1pY+G7/ra1tDbW3r6fYhnWUSm2mZGoTJRK/UxgEOgzCwEfjj+nZ0+c0P/91Wf8bi62jgcG9thix2HoKisAEGBt9yMZPLLWyFAjRt20ri7GHgsC4AGjpE8cvU7H4iUwCIW7eumLcG4wK8OzpC8qNjPq2Ovp5oiNO6fR/lExuonY2BMcAzkdcKBZnOVa8p6nJN77Xb+Xzh4aylO7qJFMYEwDGD1/M1RyHkbv7d/CWWTL4Z8CLEDdwTb/YMXQ2y92il0xgRICpydd08sTlmuMwHIGsUcNVYPzY6ANbCBVTImgLgJvcv+9Ijdtnjw1Qf3+GTDD+cIK71pjnGLrD3Xs3tGOCtgC7Mgdq3NSkizr4dTHkCnfv3yAdtDJBDHWq8Wh508YDXDN7dMBzDCMNuogOYgGcQOWmr6/XmNv70b8nw9ff4Tk2zomWTq4hFqDAKa279e3M7WAwyYqbA0pQLdvZ5gRJEQuguh5cNMiU1cEZVt34jRKNIhJghpMWte8H0e/roeYUuBd4pASRAO8K3h/7P90ZSus72FmlMlucEabeIgHyitqYsYVNuutfz/dC/iNJEAkw/9nr/h0hzd3d/J3c7PmOuYQEUUGkVPIKkOioFaDzn+1kktdvn3i+q11uoSwbCkUeoI670lxfB/U3ywshCrCaEAmgqq9b9ZGg/mar0AtFMaC1dY3nBhAT2trinnPUPmsateK0QTgMizwAlR03+fx7Chs16rdzKi5BJABK125e1SlhBYmpXETmAT5ZWJhxAKnvqymv6KnUFpIgEiDJHhBzuZzujGy5qJMf3EsiEScJ4mFQnfzozssbxa8OgbqjFLEA6owMXnCbK0RBg2m4WofQmYuIBfCbl49zN4AnBEV1mc3r/rp1CK1MEK6nBsTc9VGtAkU9cM0RvrYbZ/1QhwDL4oM19TspaHnVeHjgHQNlce25AFohe3Sw5jg8YfhCjgX6QlIgau76WI3x4AwvkZkowgS+NOas7vZt62n4hp1l9XqryytuacwBS2SXhnN1h0OUzpBFIpVG7HAvjpZKX+yqDq5RrJNY4Xx4m8n6YyDL44cPnVr2AxE/A4JdvXZ6ZS+Pu3EWNXWFcIZb3Whfj0AfkXHK1Wry0gjV2NG7rGV1CaE9Kovpa6Hw0X4A4jMXVUssiPshKdQYOv6IUzK5xc7rk8qMMyiazwpTxGkKQBGnKQBFHAgwR9FlGgKEV8xbeUwjD+ii6kuTUSTeYlnWJH/Qe9bs1ySH94ij+ursO956ll6dxQfeddPq9wSk/aja9CzaXH152nNG9VXa81R9oTJMjwhyTjJH1WA/sdjll/gBxXYaHO/Ph9AAAAAASUVORK5CYII=")
  self.brushSizeDownButton:setActivatedTexture("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")
  self.brushSizeDownButton.onActivated = function()
    self.drawableSurface:setBrushSize(self.drawableSurface.brushSize - 1)
  end
  self:addSubview(self.brushSizeDownButton)
  
  -- BRUSH SIZE UP BUTTON
  self.brushSizeUpButton = ui.Button(ui.Bounds(0,0,0, self.BUTTON_SIZE, self.BUTTON_SIZE, self.BUTTON_SIZE) )
  self.brushSizeUpButton:setDefaultTexture("iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAVtSURBVHgB7ZtBbBtFFIbfVtzYVj21cU5JpLiXVNBEQj21TeDWguFEggoccBDiQJJKICEaSgggAVLjcECoKRKCCsIJBZobhYZTqBQnUnuKpTanOOmpkt2z+/6NN5p53tT27Oy69eaTVrbX1nrfmzdv3vwz65CgUqmc4ZdX+cjw0UXtwVr1mHIcZyPwF2z4YT5mKu0PbDzs2+34xvPLv3w8T8kA0TDI0fDgQPXEJUqO8QC2wmZyuPW7+PWe+m2xeJ+mp3JUKNylUukhPe2cOn2SJi5kKZU6Kr8ahAN+4jdv+2dg/FvnP2gLw1Xcg8/SL9dmpRNm0QWeU8/MXL7SdsaDMts0PTUrT2fgAK3v/7f0P7Ur69ylBV0HKEGUAyI7UQ4IYt8BlHAS74BnKCb6B/qot7eH+vuPU/pYN7muSwd5bAYYdreK27S5eZ/y+dveUVi/R3GAQqiinjj5wstkCxj4+vArdPbci0FV2GNBQXZ17lfKr9z23tti+dZf2ufIHJAdHWHjM7utbAqMX7z+NzvjN7KBdID1HJBKHfFKzuzoG6GN96+Ha/2x8KP33jZWcwBCfXxiNNBw9HNMrpZuLnNY36Gtre3dkhu/R37oTXdzrjhOp3nyIoHxP1/7jr74PEdLS8tkC2tdAMZPfjpecx5G/j7/Jx8LDc8xYOzZcy/xMRSYO6bZCYvXb5AJkeQAtNjX335Scx6GI5GZTq788IdzJaZOsJ4DcJMXA1o+d/kqzyznQs0sPV2CDcW1JOhqNnJCaAd8/8NXNX0eNz3PIW8LXAsCjQr+85uAqGuWUEkQQ53so2itRkJThmK9rre4eIONdmmclR2f3nSPdw9hhkjjCNhJVHrfhOE2W16Ca89zXlEJW2sYOwAlrdr6fuUWNTKp+tWmKcYOyL47on1G69ssWfei7A2repRhyDTFyAFp7nuy76NcjQt0AzUK0B0RkSYYOeBEf5/2GdVdHK3vgygorOv6XpqrSBOMHDAwoHt7laevcSPL4RNxRkCqUw//9Zjm7iqr+Tva5/SxHjLBqA7o6NArsEKt3Fwzztej3u9lnbDJAoqK65oNhUYRIMfdViykSInbtBbYF0XJgJIl74fBtRSFRjmgXC5rRiMnlEp6IqxX2zc7F5DIYa8ockKjGEWAVGzlsBgHUJBUiptmdYiRA1ZW9HH/VICEFTW2ahErEYBpaZx5AKWvdLpslEYxcgAWLtQ+F3ZG1ixyGo4yvFAwK8aMh0EpethYA2iEIB0izDTc2AFyRgbj38mOUNRAJJU6RH7FfC5i7ICgefnwSIaGI+wK/jKbSlgdIpQmCC0OkjiSoM/4hVEqlR/W1QWbHfdh+ARfW8WGChW6FP7owy9rqjAskNiMBLS8XHTBf77/3scUltAOQCvkWP+XIBJw02G0e+QVqMCy5QGWyGyIMFbWBiFZg8lLeishbLHWB7msmb7qD6t7jSzTFtcHrS6PozhBq+81HHoLo9j8wPoBiil1cbSjquv5OWWvBdbczJzxuiCIfH8AQh6rRc1uiKgHNEDkm7BhH/n+ANzga5msN0KYztBU0Oq41pvnxyIRXiPdIuPL1VhDaH6LzDaH+j9NLas3QmxbZCTeBqmBPi8pdnYeYQ3hqLZJChoDxFVUdcgP+YiU5pY54Ekh8hzwtLHvAEo4+w6QJ1ohcbcSOGBDPSHV1nYiQLxdgwM0VQMTmnaMgkOHXO/JMcEa6oAztPPQ5C7eFHfmCk9eWvf8kOM4ZANvFyovolycHAuqRrv9J0exB22MkkWOnTyR1EdnV/kY2n10Fm/4ZZCPWWpvUPYj2oeqNlNNR6s+SvsZ7TxQGWdEVCg6Nmgn2S+w4TfVLx4B1Vdb/zIKkJ4AAAAASUVORK5CYII=")
  self.brushSizeUpButton:setHighlightTexture("iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAATYSURBVHgB7ZtNbBNHFMffRr2RSJwg5oQrOb0AbW2pTS91PnoLxfTU0K8LpKp6aNOqomrVtNCUHqqKmEtVKeHCZzgh83EDkXACJJsIOMUSyYkYTkg2Z/P+62y0O7uJ7TezS8j6J63W3mzW+/7zZua9N7sWKdTr9QHeHeQtx9tu2hosrG7HLctaDjyDDd/O21R96wMbtzt2W47xvLvF2zsUD+ANg+wNz7tWD/xB8TEewFbYTBa3/m7eL1E8GYQHHKP4chACvE3xJYcuUKcY00UxpyMAxZyOABRz3qCIKJUeUnlxiYpF7B9TrfaCqtUX9t96erZRb+9OSuzaQZnMXkpn9lAq9SZFQajTIAy8NHuFrl+7QSsrz9r630RiBx0Z+8wWI5HYSWERmgAz0xfZ+MJaK0uBECP7P2IxDlEYGBcALX30pxNULj8mk0CI//7/27g3GBXg+rWblJ+aDmx19PNUX5Ky2Q8ond5DvWwIjgGcj3GhXF7iseIBzc/dDbx+N58/MTFO2YF+MoUxAWD85J9533EY+enoAd5yawY3A16EcQPXDBo7Jn4f524xTCYwIsD83B36+egJ33EYjoGsVcNVYPzM9AVbCBVTImgLgJv86ovvfG4//uMRGh3NkQlmLxa4a814jqE7nD13SntM0Bbgk9xhn5uadFGHoC6GWOHs+VOkg1YghKlONR4t34rx/e997Pl+597VDc/HNavVmscTMNOgi6CbSRGHws5A5bnJkWFjbh/E6KEcX/+A59gsB1o6sYZYgBKHtO7WtyO3r8MJVtwcVgbVmh1tFkiKWAC4nhu4aJghq4MzrboJmiVaRSTAIgctat83PehthBpT4F7gkRJEAtwveX/sw2x/JK3vYEeVSra4KAy9RQIUFbWRsUVNduB9z/dS8RFJEAmw8sTr/n0R5e5u3k3v9XxHLiFBFAdUKl4BUn1+AdR5vhnNzlfjBLXLVWuyqVDkAeq8K431dVB/s1aNUICthEgAVX3dqo8E9Te7hV4oGgO6u7d5bgBjQk9P0nNOs9i+3VxARa047RJOwyIPQGXHTbH4gKJGHfV7ORSXIBIApWs3t9cpYYWJqVhE5gEBUViU4wBC39vzXtEzmX0kQSRAmj0g4XI53YysXdTkB/eSSiVJgngaVJMf3by8VYLqEK+kIKJmZPCC01whChuk4WodQicXEQsQlJfPcjeAJ4RFY5nN6/66dQjtouiXn3/vm5OjKoqi9S8XTpMOIZbFx3z1Oylo+amT055j8MAzBsri2rkAWmH8hzHf8Tzf8OTxPAv0lKRA1PzJGZ/x4DdeIjNRhAl9acxZ3R3ZP9TyDTvL6uutLm+6pTEHLJH9NZlfdzpE6QxRJEJpBFPuxdFK5ald1cE1yusEVjgf3mZyfAllefzbb35p+4GIZkCwf/79dXMvj7txFjV1hXCmW51gZyNCfUTGKVerwUsrNMaO4baW1SVE9qgs0tdS6ZH9AMQTLqpWWBD3Q1KoMfS9laR0ep8d16eVjDMsOs8KU8zpCEAxpyMAxRwIsEzxZQECRFfM23wsIA4YoMZLk3Ek2WVZ1hx/0HvW7PUkj/eI4/rq7H3ehtZencUH3g3S1vcEhP2o2gyt2tx4edpzRuNV2mPUeKEySo8IMydZpsZgX1jt8mu8BHzkKpCMret9AAAAAElFTkSuQmCC")
  self.brushSizeUpButton:setActivatedTexture("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")
  self.brushSizeUpButton.onActivated = function()
    self.drawableSurface:setBrushSize(self.drawableSurface.brushSize + 1)
  end
  self:addSubview(self.brushSizeUpButton)
  

  self:layout()

end

function Whiteboard:specification()
  return ui.View.specification(self)
end

function Whiteboard:update()

  if self.resizeHandle.entity ~= nil then 
    local m = mat4.new(self.resizeHandle.entity.components.transform.matrix) -- looks at the resizeHandle's position
    local resizeHandlePosition = m * vec3(0,0,0)

    local newWidth = resizeHandlePosition.x*2 - self.SPACING*2
    local newHeight = resizeHandlePosition.y*2 - self.SPACING*2

    if newWidth <= 1.13 then newWidth = 1.13 end
    if newHeight <= 0.5 then newHeight = 0.5 end

    self:resize(newWidth, newHeight)
  end

  self.drawableSurface:sendIfDirty()

end

function Whiteboard:resize(newWidth, newHeight)
  self.drawableSurface:resize(newWidth, newHeight)

  self:layout()
end

function Whiteboard:layout()
  -- Set correct position of all buttons
  
  self.half_width = self.drawableSurface.bounds.size.width/2
  self.half_height = self.drawableSurface.bounds.size.height/2

  self.quitButton:setBounds(ui.Bounds{pose=ui.Pose(self.half_width+self.SPACING - self.BUTTON_SIZE, self.half_height+self.SPACING, 0.05), size=self.quitButton.bounds.size})
  self.clearButton:setBounds(ui.Bounds{pose=ui.Pose(self.half_width-self.BUTTON_SIZE*2-self.SPACING*2, -self.half_height-self.SPACING, 0.05), size=self.clearButton.bounds.size})
  self.brushSizeDownButton:setBounds(ui.Bounds{pose=ui.Pose(self.half_width-self.BUTTON_SIZE-self.SPACING, -self.half_height-self.SPACING, 0.05), size=self.brushSizeDownButton.bounds.size})
  self.brushSizeUpButton:setBounds(ui.Bounds{pose=ui.Pose(self.half_width-self.BUTTON_SIZE/2, -self.half_height-self.SPACING, 0.05), size=self.brushSizeUpButton.bounds.size})
end

return Whiteboard